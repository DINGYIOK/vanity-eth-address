name: CUDA Windows Build

on: [push, pull_request]

jobs:
  build:
    runs-on: windows-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      # 1. 安装 CUDA Toolkit
      - name: Install CUDA Toolkit
        uses: Jimver/cuda-toolkit@v0.2.21
        with:
          cuda: '11.0.0' # 指定你需要的 CUDA 版本
          method: 'network' # 建议使用网络安装，速度相对较快

      # 2. 验证 nvcc 是否可用
      - name: Verify NVCC
        run: nvcc --version

      # 3. 编译 .cu 文件
      # 注意：在 Windows 上，nvcc 需要调用 MSVC 的 cl.exe
      # GitHub Actions 的环境默认已配置好路径
      - name: Compile CUDA code
        run: |
          nvcc -o my_cuda_app.exe main.cu
          
      # 4. (可选) 将生成的 exe 作为 Artifact 保存，方便下载
      - name: Upload Artifact
        uses: actions/upload-artifact@v4
        with:
          name: cuda-executable
          path: cuda_app.exe